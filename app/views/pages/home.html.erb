<div class="jumbotron">
  <h1>The shop</h1>

  <% if current_user %>
    <p>Welcome, <b><%= current_user.user_name %></b>!</p>
  <% else %>
    <p>Welcome! Start by logging in.</p>
    <p>
      <%= link_to 'Log in', '/auth/twitter', class: 'btn btn-lg btn-primary' %>
    </p>
  <% end %>
</div>

<div class="row">
  <div class="col-sm-4" id="cart">
    <div class="well well-lg">
      <h3>Your cart</h3>

      <ul id="cart-items">
        <% current_user.cart_items.each do |item| %>
          <li id="item-<%= item.id %>"><%= item.product.title %> x <%= item.quantity %></li>
        <% end %>
      </ul>

      <%= link_to 'Checkout', checkout_path, class: 'btn btn-lg btn-primary', method: :post %>
    </div>
  </div>

  <div class="col-sm-8">
    <table class="table table-striped table-hover">
      <tr>
        <th>Title</th>
        <th>Desciption</th>
        <th></th>
      </tr>

      <% @products.each do |product| %>
        <tr>
          <td><%= product.title %></td>
          <td><%= product.desc %></td>
          <% if current_user %>
            <td><%= link_to 'To cart', add_to_cart_path(product), method: :post, class: 'btn btn-primary',
                            remote: true %></td>
          <% else %>
            <td>Login to purchase!</td>
          <% end %>
        </tr>
      <% end %>
    </table>
  </div>
</div>